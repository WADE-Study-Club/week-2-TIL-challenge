## Authentication 인증과 인가
### 인증이란?
- 유저가 누구인지 확인하는 절차, 회원가입하고 로그인 하는 것!
### 인가란?
- 유저에 대한 권한을 허락하는 것.
  - 누가, 언제, 어떻게 쓰고 있는가를 파악하기 위해 어떤 사이트에서든 인증, 인가가 있다.
  - 인증과 인가는 API 에서 가장 자주 구현되는 기능 중 하나이다.

## 인증

### Q1. 어떻게 하면 안전하게 정보를 통신에 첨부해 사용자에게 전달 할 수 있을까?  
### Q2. 민감한 정보가 아니면서 동시에 일정시간동안 유효하게, 도용되지 않게 하는 방법은 없을까?

- 옵션 1. 아이디, 비밀번호를 같이 보낸다 -> 매번 서버에서 확인해야하고 정보의 민감성이 커진다.
- 옵션 2. 시간제한이 있는 임시 아이디를 보낸다 -> 어떤 유저인지 모르고, 또 그 유저의 정보를 따로 또 저장해야한다.  
(실제 유저 정보와 맵핑을 따로 진행해야함)
- 옵션 3. 일정 시간동안 인가에 유효한 정보로 대체한다. -> JWT(JSON Web Token) 이용

=========

### JWT?

- table ID를 준다.
- 그 정보를 JSON 형태로 전달한다. ( 객체 형태 )
- 유효 기간도 전달한다.
- http headers 에서 이용할 수 있도록 JSON을 'token'화 한다.
- ### Authorization header 부분에 같이 첨부해서 보낸다. 프론트에서 리퀘스트가 있으면  
    저장하고 있던 토큰을 백에 첨부해서 같이 보내준다.

## 인가

### 유저가 요청하는 request를 실행할 수 있는 권한이 있는 유저인가를 확인하는 절차.
- 'JWT'를 쓰면 인가가 수월함. 서버가 유저 정보를 갖고 있으므로 데이터에서 유저의 권한 정보도 읽어들이면 됨.
- 'access token'을 통해 해당 유저 정보를 얻을 수 있음으로 해당 유저가 가지고 있는 권한(permission) 도 확인가능.

## Authorization 절차
1. Authentication 절차를 통해 access token을 생성한다. access token에는 유저 정보를 확인할 수 있는 정보가 들어가 있어야 한다 (예를 들어 user id).
2. 유저가 request를 보낼때 access token을 첨부해서 보낸다.
3. 서버에서는 유저가 보낸 access token을 복호화 한다.
4. 복호화된 데이터를 통해 user id를 얻는다.
5. user id를 사용해서 database에서 해당 유저의 권한(permission)을 확인하다.
6. 유저가 충분한 권한을 가지고 있으면 해당 요청을 처리한다.
7. 유저가 권한을 가지고 있지 않으면 Unauthorized Response(401) 혹은 다른 에러 코드를 보낸다.